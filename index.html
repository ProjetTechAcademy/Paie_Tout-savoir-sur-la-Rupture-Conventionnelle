<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de Rupture Conventionnelle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Professional -->
    <!-- Application Structure Plan: L'application est con√ßue autour de l'utilisateur qui cherche √† comprendre et √† planifier une rupture conventionnelle. La structure est donc orient√©e vers l'action et la clarification. Elle se divise en trois p√¥les : 1) Un guide visuel et chronologique de la proc√©dure, 2) Des simulateurs interactifs pour les √©ch√©ances et l'indemnit√©, et 3) Des fiches d'information claires sur les conditions et cas particuliers. Cette architecture transforme le contenu dense du diaporama en un parcours utilisateur logique, de la compr√©hension des r√®gles (Qui ? Quand ?) √† la planification concr√®te (Quelles dates ? Quel montant ?). -->
    <!-- Visualization & Content Choices: 
        1. Info: Proc√©dure de rupture conventionnelle -> Goal: Organiser et clarifier la chronologie -> Viz: Calculateur de calendrier interactif (HTML/JS) -> Interaction: L'utilisateur entre une date de signature et l'outil calcule automatiquement les dates cl√©s (fin de r√©tractation, envoi de la demande, fin d'instruction, date de rupture la plus proche). -> Justification: C'est l'√©l√©ment le plus utile, car il traduit des r√®gles complexes (jours calendaires vs. jours ouvrables) en un planning personnalis√© et concret.
        2. Info: Calcul de l'indemnit√© minimale -> Goal: Informer et simuler -> Viz: Calculateur d'indemnit√© (HTML/JS) avec affichage clair du r√©sultat. -> Interaction: L'utilisateur saisit son anciennet√© et son salaire de r√©f√©rence pour obtenir le montant minimum l√©gal. -> Justification: R√©pond √† la question financi√®re principale de l'utilisateur de mani√®re directe et personnalis√©e.
        3. Info: Conditions d'√©ligibilit√©, cas d'interdiction, r√©gime social -> Goal: Informer -> Viz: Cartes stylis√©es avec ic√¥nes Unicode (HTML/Tailwind). -> Interaction: Statique mais structur√© pour une lecture rapide. -> Justification: Segmente l'information r√©glementaire en blocs digestes, ce qui est plus efficace qu'un long paragraphe.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4;
            color: #3D405B;
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #81B29A;
            border-bottom-color: #81B29A;
        }
        .btn-primary {
            background-color: #81B29A;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #6a947d;
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.07);
        }
        input, select {
            border-color: #E0E0E0;
        }
        input:focus, select:focus {
            border-color: #81B29A;
            box-shadow: 0 0 0 2px rgba(129, 178, 154, 0.3);
            outline: none;
        }
        .timeline-step {
            border-left: 3px solid #81B29A;
        }
        .timeline-step:last-child {
            border-left: 3px solid transparent;
        }
        .timeline-dot {
            background-color: #81B29A;
        }
        .legal-note {
            background-color: #fff5f5;
            border-left: 4px solid #ef4444;
            color: #b91c1c;
            padding: 1rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl text-gray-800">‚úçÔ∏è Guide Rupture Conventionnelle</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#procedure" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">La Proc√©dure</a>
                        <a href="#simulateurs" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">Simulateurs</a>
                        <a href="#conditions" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">Conditions</a>
                        <a href="#regime" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">R√©gime Social</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-900">Tout savoir sur la Rupture Conventionnelle</h1>
            <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Un outil interactif pour ma√Ætriser la proc√©dure, calculer vos d√©lais et estimer votre indemnit√© de d√©part.</p>
        </div>

        <section id="procedure" class="mb-16 scroll-mt-20">
            <div class="card p-6 md:p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">La Proc√©dure √âtape par √âtape</h2>
                <p class="text-gray-600 mb-8">La rupture conventionnelle (r√©gie par les articles <a href="#" class="text-indigo-600 font-medium">L.1237-11 √† L.1237-16</a> du Code du travail) suit un calendrier pr√©cis de d√©lais incompressibles. Voici les √©tapes cl√©s.</p>
                
                <div class="space-y-8">
                    <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 1 : Le ou les entretiens</h3>
                        <p class="text-gray-600">L'employeur et le salari√© conviennent des conditions de la rupture. Au moins un entretien est obligatoire.</p>
                    </div>
                    <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 2 : Signature de la convention</h3>
                        <p class="text-gray-600">Les conditions sont formalis√©es dans le formulaire Cerfa. La signature d√©clenche le d√©lai de r√©tractation.</p>
                    </div>
                    <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 3 : D√©lai de r√©tractation (15 jours calendaires)</h3>
                        <p class="text-gray-600">Selon l'article <a href="#" class="text-indigo-600 font-medium">L.1237-13</a> du Code du travail, chaque partie dispose de 15 jours calendaires pour annuler la proc√©dure.</p>
                    </div>
                    <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 4 : Demande d'homologation √† la DREETS</h3>
                        <p class="text-gray-600">La convention est envoy√©e √† l'administration pour validation via le service T√©l√©RC.</p>
                    </div>
                    <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 5 : D√©lai d'instruction (15 jours ouvrables)</h3>
                        <p class="text-gray-600">La DREETS v√©rifie la validit√©. L'absence de r√©ponse vaut acceptation (homologation tacite).</p>
                    </div>
                     <div class="relative timeline-step pl-8">
                        <div class="absolute -left-2 top-1 w-4 h-4 rounded-full timeline-dot"></div>
                        <h3 class="font-bold text-lg text-gray-800">√âtape 6 : Fin du contrat de travail</h3>
                        <p class="text-gray-600">La rupture peut intervenir au plus t√¥t le lendemain de la fin du d√©lai d'instruction.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="simulateurs" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Simulateurs Pratiques</h2>
            <div class="card p-6 md:p-8 mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">üóìÔ∏è Calculateur de D√©lais & Anciennet√©</h3>
                <p class="text-gray-600 mb-4">Entrez les dates pour estimer les d√©lais cl√©s et calculer l'anciennet√© automatiquement.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="signatureDate" class="block text-sm font-medium text-gray-700">Date de signature de la convention</label>
                        <input type="date" id="signatureDate" class="mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                         <label for="dateEntree" class="block text-sm font-medium text-gray-700">Date d'entr√©e du salari√©</label>
                        <input type="date" id="dateEntree" class="mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                </div>
                 <div class="mt-4">
                    <label for="dateDepartSouhaitee" class="block text-sm font-medium text-gray-700">Date de d√©part souhait√©e (si > date l√©gale)</label>
                    <input type="date" id="dateDepartSouhaitee" class="mt-1 block w-full md:w-1/2 rounded-md shadow-sm p-2">
                </div>
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <ul class="space-y-3">
                        <li class="flex justify-between items-center p-3 bg-gray-50 rounded-md">
                            <span class="font-medium text-gray-700">Fin du d√©lai de r√©tractation :</span>
                            <span id="retractationEnd" class="font-bold text-indigo-600">-</span>
                        </li>
                        <li class="flex justify-between items-center p-3 bg-gray-50 rounded-md">
                            <span class="font-medium text-gray-700">Fin du d√©lai d'instruction :</span>
                            <span id="instructionEnd" class="font-bold text-indigo-600">-</span>
                        </li>
                        <li class="flex justify-between items-center p-3 bg-green-100 rounded-md">
                            <span class="font-medium text-green-800">Date de sortie l√©gale au plus t√¥t :</span>
                            <span id="rupturePossible" class="font-bold text-green-800">-</span>
                        </li>
                    </ul>
                    <div class="p-4 bg-blue-50 rounded-lg border border-blue-200 text-center flex flex-col justify-center">
                        <p class="text-lg font-medium text-blue-800">Anciennet√© calcul√©e :</p>
                        <p id="ancienneteResult" class="text-3xl font-bold text-blue-700 mt-1">-</p>
                    </div>
                </div>
            </div>
            
            <div class="card p-6 md:p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">üí∞ Simulateur D√©taill√© d'Indemnit√©</h3>
                <p class="text-gray-600 mb-4">Saisissez les salaires pour estimer l'indemnit√© minimale l√©gale bas√©e sur l'anciennet√© calcul√©e ci-dessus.</p>
                
                <div class="legal-note">
                    <p><strong><em>Quelle p√©riode de r√©mun√©ration prendre en compte ? Selon les textes en vigueur (notamment l'article L.1234-9 du Code du travail, applicable par renvoi), le salaire de r√©f√©rence est calcul√© sur la base des r√©mun√©rations brutes per√ßues par le salari√© AVANT la date de signature de la convention. Le salaire du mois de la rupture effective n'est donc pas inclus dans la base de calcul.</em></strong></p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                     <div>
                        <label for="primes" class="block text-sm font-medium text-gray-700">Primes annuelles/exceptionnelles brutes (sur les 12 mois avant signature)</label>
                        <input type="number" id="primes" placeholder="Ex: 1500" class="mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                </div>

                <div class="mt-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Saisie des 12 derniers salaires bruts (avant signature)</h4>
                    <div id="salaires-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                        <p class="text-sm text-gray-500 col-span-full">Veuillez d'abord s√©lectionner une date de signature ci-dessus.</p>
                    </div>
                </div>

                <div class="legal-note">
                    <p><strong><em>Comment calculer l'anciennet√© ? L'anciennet√© du salari√© s'appr√©cie √† la date de rupture effective du contrat de travail (c'est-√†-dire √† la fin de toute la proc√©dure), et non √† la date de signature de la convention. C'est ce que pr√©cise la circulaire DGT n¬∞ 2009-04.</em></strong></p>
                    <p class="mt-2 text-sm"><strong>Exemple concret :</strong> Un salari√© signe sa convention le 10 janvier. Apr√®s tous les d√©lais, sa date de rupture effective est fix√©e au 1er mars. C'est son anciennet√© au 1er mars qui sera utilis√©e pour le calcul de l'indemnit√©.</p>
                </div>
                
                <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <p class="text-sm font-medium text-gray-600">Moyenne / 12 mois : <span id="avg12" class="font-bold">-</span></p>
                         <p class="text-sm font-medium text-gray-600">Moyenne / 3 mois : <span id="avg3" class="font-bold">-</span></p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-lg border border-green-200">
                        <p class="text-sm font-medium text-green-800">Salaire de r√©f√©rence retenu :</p>
                        <p id="salaireRefResult" class="text-2xl font-bold text-green-700">-</p>
                    </div>
                </div>

                <div class="mt-4 text-center p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <p class="text-lg font-medium text-blue-800">Montant minimum de l'indemnit√© :</p>
                    <p id="indemniteResult" class="text-4xl font-bold text-blue-700 mt-1">-</p>
                </div>
                <div id="indemnite-details" class="mt-4 p-4 bg-gray-50 rounded-lg text-sm space-y-2 hidden">
                     <h4 class="font-bold text-gray-800">D√©tail du calcul de l'indemnit√©</h4>
                     <p id="calc-detail-salaire-ref"></p>
                     <p id="calc-detail-anciennete-decimal"></p>
                     <p id="calc-detail-part1"></p>
                     <p id="calc-detail-part2"></p>
                     <p id="calc-detail-total" class="font-bold pt-2 border-t mt-2"></p>
                </div>
            </div>
        </section>

        <section id="conditions" class="mb-16 scroll-mt-20">
            <div class="card p-6 md:p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Conditions & Cas Particuliers</h2>
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <h4 class="font-bold text-blue-800 flex items-center"><span class="text-xl mr-2">‚úÖ</span> Qui est √©ligible ?</h4>
                        <ul class="list-disc list-inside text-sm text-gray-700 mt-2 pl-2">
                            <li>Salari√©s en CDI uniquement.</li>
                            <li>Hors p√©riode d'essai.</li>
                            <li>Le commun accord est indispensable.</li>
                        </ul>
                    </div>
                     <div class="p-4 bg-red-50 border border-red-200 rounded-lg">
                        <h4 class="font-bold text-red-800 flex items-center"><span class="text-xl mr-2">‚ùå</span> Quand est-ce interdit ?</h4>
                        <ul class="list-disc list-inside text-sm text-gray-700 mt-2 pl-2">
                            <li>Si le consentement est vici√© (fraude, pression).</li>
                            <li>Dans le cadre d'un PSE ou d'un accord GPEC.</li>
                            <li>Pour contourner les r√®gles du licenciement √©conomique.</li>
                        </ul>
                    </div>
                     <div class="p-4 bg-yellow-50 border border-yellow-300 rounded-lg">
                        <h4 class="font-bold text-yellow-800 flex items-center"><span class="text-xl mr-2">üõ°Ô∏è</span> Salari√©s prot√©g√©s ?</h4>
                        <p class="text-sm text-gray-700 mt-2 pl-2">La proc√©dure est similaire mais la validation ne vient pas de la DREETS. Elle est soumise √† l'<strong class="font-semibold">autorisation de l'inspecteur du travail</strong>, apr√®s consultation du CSE si existant.</p>
                    </div>
                 </div>
            </div>
        </section>

        <section id="regime" class="scroll-mt-20">
            <div class="card p-6 md:p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">R√©gime Fiscal et Social de l'Indemnit√©</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-gray-800">Cas 1 : Salari√© <span class="text-red-600">non</span> en droit de prendre sa retraite</h3>
                        <div class="space-y-3 text-sm">
                            <p><strong>Imp√¥t sur le revenu :</strong> Exon√©r√©e dans la limite la plus √©lev√©e entre 1) l'indemnit√© l√©gale/conventionnelle, 2) 50% de l'indemnit√© vers√©e ou 2x le salaire brut N-1 (plafond global de 6 PASS).</p>
                            <p><strong>Cotisations sociales :</strong> Exon√©r√©e jusqu'√† 2 PASS si exon√©r√©e d'imp√¥t.</p>
                             <p><strong>CSG/CRDS :</strong> Exon√©r√©e dans la limite de l'indemnit√© l√©gale/conventionnelle (sans d√©passer la part exon√©r√©e de cotisations sociales).</p>
                             <p><strong>Contribution patronale (30%) :</strong> Due sur la part exon√©r√©e de cotisations sociales.</p>
                        </div>
                    </div>
                     <div>
                        <h3 class="text-xl font-semibold mb-3 text-gray-800">Cas 2 : Salari√© en droit de prendre sa retraite</h3>
                         <div class="space-y-3 text-sm">
                             <p><strong>Imp√¥t sur le revenu :</strong> Soumise d√®s le 1er euro (r√©gime d'un d√©part √† la retraite).</p>
                             <p><strong>Cotisations sociales :</strong> Soumise d√®s le 1er euro.</p>
                             <p><strong>CSG/CRDS :</strong> Soumise d√®s le 1er euro apr√®s abattement.</p>
                             <p><strong>Contribution patronale (30%) :</strong> Due sur la part exon√©r√©e de cotisations sociales (si une exon√©ration s'applique exceptionnellement).</p>
                        </div>
                    </div>
                </div>
                <div class="mt-8 border-t pt-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Exemple concret & Bulletin de paie simplifi√© (Cas 1)</h4>
                    <div class="text-sm p-4 bg-gray-50 rounded-lg">
                        <p><strong>Hypoth√®ses :</strong></p>
                        <ul class="list-disc list-inside ml-4">
                            <li>Indemnit√© l√©gale ou conventionnelle : <strong>10 000 ‚Ç¨</strong></li>
                            <li>Indemnit√© de rupture vers√©e : <strong>30 000 ‚Ç¨</strong></li>
                            <li>Salaire brut annuel (N-1) : <strong>45 000 ‚Ç¨</strong></li>
                            <li>Plafond Annuel de la S√©curit√© Sociale (PASS) en 2025 : <strong>47 100 ‚Ç¨</strong></li>
                        </ul>
                    </div>
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="p-4 border rounded-lg">
                            <p class="font-bold">1. Limite d'exon√©ration fiscale</p>
                            <p class="text-xs">On retient le montant le plus √©lev√© :</p>
                            <ul class="list-decimal list-inside text-xs ml-4 mt-1">
                                <li>Indemnit√© l√©gale: 10 000 ‚Ç¨</li>
                                <li>50% de l'indemnit√© vers√©e: 15 000 ‚Ç¨</li>
                                <li>2x Salaire N-1: 90 000 ‚Ç¨ (plafonn√© √† 6 PASS)</li>
                            </ul>
                            <p class="mt-2 p-2 bg-green-100 text-green-800 rounded text-sm font-bold">Exon√©ration IR = 15 000 ‚Ç¨</p>
                        </div>
                        <div class="p-4 border rounded-lg">
                             <p class="font-bold">2. Limite d'exon√©ration sociale</p>
                            <p class="text-xs">Limit√©e √† 2 PASS (94 200 ‚Ç¨). L'indemnit√© vers√©e (30 000 ‚Ç¨) est inf√©rieure.</p>
                            <p class="mt-2 p-2 bg-green-100 text-green-800 rounded text-sm font-bold">Exon√©ration cotisations = 30 000 ‚Ç¨</p>
                        </div>
                        <div class="p-4 border rounded-lg">
                            <p class="font-bold">3. Limite d'exon√©ration CSG/CRDS</p>
                            <p class="text-xs">On retient le montant le plus bas entre la part exon√©r√©e de cotisations (30 000 ‚Ç¨) et l'indemnit√© l√©gale (10 000 ‚Ç¨).</p>
                            <p class="mt-2 p-2 bg-green-100 text-green-800 rounded text-sm font-bold">Exon√©ration CSG/CRDS = 10 000 ‚Ç¨</p>
                        </div>
                    </div>
                    <div class="mt-6 overflow-x-auto">
                        <p class="font-semibold mb-2">Simulation sur le bulletin de paie du solde de tout compte (Cas 1):</p>
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="text-left py-2 px-3 text-sm font-medium">Libell√©</th>
                                    <th class="text-right py-2 px-3 text-sm font-medium">Base</th>
                                    <th class="text-right py-2 px-3 text-sm font-medium">Montant Brut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="py-2 px-3 text-sm">Salaire du mois (ex: 15 jours)</td>
                                    <td class="text-right py-2 px-3 text-sm">1 800,00 ‚Ç¨</td>
                                    <td class="text-right py-2 px-3 text-sm">1 800,00 ‚Ç¨</td>
                                </tr>
                                <tr class="border-b bg-blue-50">
                                    <td class="py-2 px-3 text-sm font-medium">Indemnit√© de rupture conventionnelle</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                    <td class="text-right py-2 px-3 text-sm font-medium">30 000,00 ‚Ç¨</td>
                                </tr>
                                 <tr class="border-b">
                                    <td class="py-2 px-3 pl-8 text-xs italic">...dont part totalement exon√©r√©e</td>
                                    <td class="text-right py-2 px-3 text-xs italic"></td>
                                    <td class="text-right py-2 px-3 text-xs italic">(10 000,00 ‚Ç¨)</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="py-2 px-3 text-sm text-red-600">Partie de l'indemnit√© soumise √† CSG/CRDS (9,7%)</td>
                                    <td class="text-right py-2 px-3 text-sm text-red-600">20 000,00 ‚Ç¨</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                </tr>
                                <tr class="border-b">
                                    <td class="py-2 px-3 text-sm text-red-600">Partie de l'indemnit√© soumise √† l'imp√¥t</td>
                                    <td class="text-right py-2 px-3 text-sm text-red-600">15 000,00 ‚Ç¨</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                </tr>
                                <tr class="bg-gray-100 font-bold">
                                    <td class="py-2 px-3 text-sm">Total Brut Soumis √† Cotisations Sociales</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                    <td class="text-right py-2 px-3 text-sm">1 800,00 ‚Ç¨</td>
                                </tr>
                            </tbody>
                        </table>
                         <p class="text-xs text-gray-500 mt-2">Ce bulletin est une simplification. Il ne montre pas le d√©tail des cotisations salariales, patronales ni le pr√©l√®vement √† la source.</p>
                    </div>
                </div>

                 <div class="mt-8 border-t pt-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Exemple concret & Bulletin de paie simplifi√© (Cas 2)</h4>
                    <div class="text-sm p-4 bg-gray-50 rounded-lg">
                        <p><strong>Hypoth√®ses :</strong></p>
                        <ul class="list-disc list-inside ml-4">
                            <li>Salari√© en droit de b√©n√©ficier d'une pension de retraite.</li>
                            <li>Indemnit√© de rupture vers√©e : <strong>25 000 ‚Ç¨</strong></li>
                        </ul>
                        <p class="mt-2">Dans ce cas, le r√©gime est beaucoup plus simple : l'int√©gralit√© de l'indemnit√© est trait√©e comme un salaire.</p>
                    </div>
                    <div class="mt-6 overflow-x-auto">
                        <p class="font-semibold mb-2">Simulation sur le bulletin de paie du solde de tout compte (Cas 2):</p>
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="text-left py-2 px-3 text-sm font-medium">Libell√©</th>
                                    <th class="text-right py-2 px-3 text-sm font-medium">Base</th>
                                    <th class="text-right py-2 px-3 text-sm font-medium">Montant Brut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="py-2 px-3 text-sm">Salaire du mois (ex: 15 jours)</td>
                                    <td class="text-right py-2 px-3 text-sm">1 800,00 ‚Ç¨</td>
                                    <td class="text-right py-2 px-3 text-sm">1 800,00 ‚Ç¨</td>
                                </tr>
                                <tr class="border-b bg-red-50">
                                    <td class="py-2 px-3 text-sm font-medium text-red-700">Indemnit√© de rupture (enti√®rement soumise)</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                    <td class="text-right py-2 px-3 text-sm font-medium text-red-700">25 000,00 ‚Ç¨</td>
                                </tr>
                                <tr class="bg-gray-100 font-bold">
                                    <td class="py-2 px-3 text-sm">Total Brut Soumis √† Cotisations Sociales</td>
                                    <td class="text-right py-2 px-3 text-sm"></td>
                                    <td class="text-right py-2 px-3 text-sm">26 800,00 ‚Ç¨</td>
                                </tr>
                            </tbody>
                        </table>
                         <p class="text-xs text-gray-500 mt-2">Ce bulletin montre que l'indemnit√© s'ajoute au salaire pour former la base de calcul des cotisations sociales et de l'imp√¥t.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const signatureDateInput = document.getElementById('signatureDate');
        const dateEntreeInput = document.getElementById('dateEntree');
        const dateDepartSouhaiteeInput = document.getElementById('dateDepartSouhaitee');
        
        const primesInput = document.getElementById('primes');
        const salairesContainer = document.getElementById('salaires-container');
        const indemniteDetailsContainer = document.getElementById('indemnite-details');

        let ruptureLegaleDate = null;
        let ancienneteGlobale = { years: 0, months: 0, days: 0, decimal: 0 };
        
        function format(date) {
            if (!date) return null;
            return date.toISOString().split('T')[0];
        }

        function formatDate(date) {
            if (!date) return '-';
            return date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }
        
        function calculateTimelineAndAnciennete() {
            const signatureDate = signatureDateInput.valueAsDate;
            if (!signatureDate) {
                document.getElementById('retractationEnd').textContent = '-';
                document.getElementById('instructionEnd').textContent = '-';
                document.getElementById('rupturePossible').textContent = '-';
                ruptureLegaleDate = null;
                updateAncienneteDisplay();
                return;
            };

            const utcStartDate = new Date(Date.UTC(signatureDate.getFullYear(), signatureDate.getMonth(), signatureDate.getDate()));

            let retractationEnd = new Date(utcStartDate);
            retractationEnd.setUTCDate(retractationEnd.getUTCDate() + 15);
            
            if (retractationEnd.getUTCDay() === 6) { 
                retractationEnd.setUTCDate(retractationEnd.getUTCDate() + 2);
            } else if (retractationEnd.getUTCDay() === 0) {
                retractationEnd.setUTCDate(retractationEnd.getUTCDate() + 1);
            }
            
            let envoiDreets = new Date(retractationEnd);
            envoiDreets.setUTCDate(envoiDreets.getUTCDate() + 1);
            
            let instructionEnd = new Date(envoiDreets);
            let joursOuvrables = 0;
            while (joursOuvrables < 15) {
                instructionEnd.setUTCDate(instructionEnd.getUTCDate() + 1);
                const day = instructionEnd.getUTCDay();
                if (day !== 0 && day !== 6) {
                    joursOuvrables++;
                }
            }
            
            let rupturePossible = new Date(instructionEnd);
            rupturePossible.setUTCDate(rupturePossible.getUTCDate() + 1);
            ruptureLegaleDate = rupturePossible;

            document.getElementById('retractationEnd').textContent = formatDate(retractationEnd);
            document.getElementById('instructionEnd').textContent = formatDate(instructionEnd);
            document.getElementById('rupturePossible').textContent = formatDate(rupturePossible);
            
            updateAncienneteDisplay();
        }

        function updateAncienneteDisplay(){
            const dateEntree = dateEntreeInput.valueAsDate;
            const dateDepartSouhaitee = dateDepartSouhaiteeInput.valueAsDate;

            if(!dateEntree || !ruptureLegaleDate){
                document.getElementById('ancienneteResult').textContent = '-';
                ancienneteGlobale = { years: 0, months: 0, days: 0, decimal: 0 };
                calculateDetailedIndemnity();
                return;
            }

            let dateEffectiveRupture = new Date(ruptureLegaleDate.getTime());
             if (dateDepartSouhaitee && dateDepartSouhaitee > ruptureLegaleDate) {
                dateEffectiveRupture = dateDepartSouhaitee;
            }
            
            let dateEntreeUTC = new Date(Date.UTC(dateEntree.getFullYear(), dateEntree.getMonth(), dateEntree.getDate()));
            let dateEffectiveRuptureUTC = new Date(Date.UTC(dateEffectiveRupture.getFullYear(), dateEffectiveRupture.getMonth(), dateEffectiveRupture.getDate()));
            
            let years = dateEffectiveRuptureUTC.getUTCFullYear() - dateEntreeUTC.getUTCFullYear();
            let months = dateEffectiveRuptureUTC.getUTCMonth() - dateEntreeUTC.getUTCMonth();
            let days = dateEffectiveRuptureUTC.getUTCDate() - dateEntreeUTC.getUTCDate();

            if (days < 0) {
                months--;
                const prevMonth = new Date(dateEffectiveRuptureUTC.getUTCFullYear(), dateEffectiveRuptureUTC.getUTCMonth(), 0);
                days += prevMonth.getUTCDate();
            }
            if (months < 0) {
                years--;
                months += 12;
            }
            
            ancienneteGlobale = { years, months, days, decimal: years + (months / 12) + (days / 365.25 / 12) };
            document.getElementById('ancienneteResult').textContent = `${years} an(s), ${months} mois et ${days} jour(s)`;
            calculateDetailedIndemnity();
        }

        function generateSalaireInputs() {
            const sigDate = signatureDateInput.valueAsDate;
            if (!sigDate) {
                salairesContainer.innerHTML = '<p class="text-sm text-gray-500 col-span-full">Veuillez s√©lectionner une date de signature.</p>';
                return;
            }

            salairesContainer.innerHTML = '';
            const monthFormatter = new Intl.DateTimeFormat('fr-FR', { month: 'long', year: 'numeric' });
            
            for (let i = 1; i <= 12; i++) {
                let date = new Date(sigDate.getFullYear(), sigDate.getMonth() - i, 1);
                const monthName = monthFormatter.format(date);
                
                const div = document.createElement('div');
                const label = document.createElement('label');
                label.className = 'block text-xs font-medium text-gray-600';
                label.textContent = `Salaire ${monthName}`;
                
                const input = document.createElement('input');
                input.type = 'number';
                input.className = 'salaire-input mt-1 block w-full rounded-md shadow-sm p-2 text-sm';
                input.placeholder = 'Brut (‚Ç¨)';
                input.dataset.monthIndex = i;
                input.addEventListener('input', calculateDetailedIndemnity);
                
                div.appendChild(label);
                div.appendChild(input);
                salairesContainer.appendChild(div);
            }
        }
        
        function calculateDetailedIndemnity() {
            const salaireInputs = Array.from(document.querySelectorAll('.salaire-input'));
            if(salaireInputs.length === 0) return;

            const salaires = salaireInputs.map(input => parseFloat(input.value) || 0);
            
            const primes = parseFloat(primesInput.value) || 0;
            const primeMensuelle = primes / 12;

            const salairesAvecPrimes = salaires.map(s => s + primeMensuelle);

            const sum12 = salairesAvecPrimes.reduce((a, b) => a + b, 0);
            const avg12 = sum12 > 0 ? sum12 / 12 : 0;

            const sum3 = salairesAvecPrimes.slice(0, 3).reduce((a, b) => a + b, 0);
            const avg3 = sum3 > 0 ? sum3 / 3 : 0;

            const salaireRef = Math.max(avg12, avg3);

            document.getElementById('avg12').textContent = isNaN(avg12) ? '-' : formatCurrency(avg12);
            document.getElementById('avg3').textContent = isNaN(avg3) ? '-' : formatCurrency(avg3);
            document.getElementById('salaireRefResult').textContent = isNaN(salaireRef) || salaireRef === 0 ? '-' : formatCurrency(salaireRef);

            const { decimal: totalAnciennete } = ancienneteGlobale;
            
            let indemnite = 0;
            let part1 = 0;
            let part2 = 0;

            if (salaireRef > 0 && totalAnciennete > 0) {
                const anciennetePart1 = Math.min(10, totalAnciennete);
                part1 = (salaireRef / 4) * anciennetePart1;

                const anciennetePart2 = Math.max(0, totalAnciennete - 10);
                if (anciennetePart2 > 0) {
                   part2 = (salaireRef / 3) * anciennetePart2;
                }
                indemnite = part1 + part2;
            }
            
            document.getElementById('indemniteResult').textContent = formatCurrency(indemnite);

            if(indemnite > 0) {
                indemniteDetailsContainer.classList.remove('hidden');
                document.getElementById('calc-detail-salaire-ref').textContent = `Salaire de r√©f√©rence : ${formatCurrency(salaireRef)}`;
                document.getElementById('calc-detail-anciennete-decimal').textContent = `Anciennet√© convertie : ${totalAnciennete.toFixed(4)} ann√©es`;
                document.getElementById('calc-detail-part1').textContent = `Part ‚â§ 10 ans : (${formatCurrency(salaireRef)} / 4) * ${Math.min(10, totalAnciennete).toFixed(4)} = ${formatCurrency(part1)}`;
                document.getElementById('calc-detail-part2').textContent = `Part > 10 ans : (${formatCurrency(salaireRef)} / 3) * ${Math.max(0, totalAnciennete - 10).toFixed(4)} = ${formatCurrency(part2)}`;
                document.getElementById('calc-detail-total').textContent = `Total : ${formatCurrency(part1)} + ${formatCurrency(part2)} = ${formatCurrency(indemnite)}`;
            } else {
                indemniteDetailsContainer.classList.add('hidden');
            }
        }
        
        function formatCurrency(value) {
            return new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(value);
        }

        signatureDateInput.addEventListener('change', () => {
             calculateTimelineAndAnciennete();
             generateSalaireInputs();
        });
        dateEntreeInput.addEventListener('change', calculateTimelineAndAnciennete);
        dateDepartSouhaiteeInput.addEventListener('change', calculateTimelineAndAnciennete);
        
        primesInput.addEventListener('input', calculateDetailedIndemnity);
        
        const today = new Date();
        const todayString = format(today);
        signatureDateInput.value = todayString;

        const fiveYearsAgo = new Date();
        fiveYearsAgo.setFullYear(today.getFullYear() - 5);
        dateEntreeInput.value = format(fiveYearsAgo);

        calculateTimelineAndAnciennete();
        generateSalaireInputs();
        
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('section');

        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.4 };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navLinks.forEach(link => {
                        link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                    });
                }
            });
        }, observerOptions);
        sections.forEach(section => { observer.observe(section); });
    });
    </script>
</body>
</html>

